@page
@model BookWise.Web.Pages.SettingsModel
@{
    ViewData["Title"] = "Settings";
    ViewData["MainClass"] = "main-content--wide";
}

<div class="settings-page">
    <div class="settings-shell">
        <header class="settings-header">
            <h1 class="settings-title">Settings</h1>
            <nav class="settings-tabs" role="tablist" aria-label="Settings categories">
                <button type="button"
                        id="settings-tab-general"
                        class="settings-tab is-active"
                        role="tab"
                        aria-selected="true"
                        aria-controls="settings-panel-general"
                        data-tab="general">
                    General
                </button>
                <button type="button"
                        id="settings-tab-appearance"
                        class="settings-tab"
                        role="tab"
                        aria-selected="false"
                        aria-controls="settings-panel-appearance"
                        data-tab="appearance">
                    Appearance
                </button>
                <button type="button"
                        id="settings-tab-account"
                        class="settings-tab"
                        role="tab"
                        aria-selected="false"
                        aria-controls="settings-panel-account"
                        data-tab="account">
                    Account
                </button>
                <button type="button"
                        id="settings-tab-notifications"
                        class="settings-tab"
                        role="tab"
                        aria-selected="false"
                        aria-controls="settings-panel-notifications"
                        data-tab="notifications">
                    Notifications
                </button>
            </nav>
        </header>

        <div class="settings-panels">
            <section id="settings-panel-general"
                     class="settings-panel is-active"
                     role="tabpanel"
                     aria-labelledby="settings-tab-general"
                     data-tab-panel="general">
                <div class="settings-section">
                    <h2 class="settings-section-title">Language</h2>
                    <div class="settings-field">
                        <label class="settings-field-label" for="language-select">Preferred language</label>
                        <div class="settings-select">
                            <select id="language-select" class="settings-select-control">
                                <option value="en-US" selected>English (United States)</option>
                                <option value="en-GB">English (United Kingdom)</option>
                                <option value="es-ES">Español (España)</option>
                                <option value="fr-FR">Français (France)</option>
                                <option value="de-DE">Deutsch (Deutschland)</option>
                                <option value="it-IT">Italiano (Italia)</option>
                                <option value="pt-BR">Português (Brasil)</option>
                                <option value="ja-JP">日本語 (日本)</option>
                                <option value="ko-KR">한국어 (대한민국)</option>
                                <option value="zh-CN">中文 (简体)</option>
                            </select>
                            <svg class="settings-select-icon" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.954l3.71-3.724a.75.75 0 111.08 1.04l-4.24 4.258a1 1 0 01-1.42 0L5.25 8.27a.75.75 0 01-.02-1.06z" clip-rule="evenodd" />
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h2 class="settings-section-title">Theme</h2>
                    <div class="theme-choice-group" role="radiogroup" aria-label="Theme">
                        <button type="button" class="theme-choice is-active" data-theme="light" aria-pressed="true">Light</button>
                        <button type="button" class="theme-choice" data-theme="dark" aria-pressed="false">Dark</button>
                        <button type="button" class="theme-choice" data-theme="forest" aria-pressed="false">Forest</button>
                        <button type="button" class="theme-choice" data-theme="ocean" aria-pressed="false">Ocean</button>
                        <button type="button" class="theme-choice" data-theme="sunset" aria-pressed="false">Sunset</button>
                        <button type="button" class="theme-choice" data-theme="rose" aria-pressed="false">Rose</button>
                        <button type="button" class="theme-choice" data-theme="lavender" aria-pressed="false">Lavender</button>
                        <button type="button" class="theme-choice" data-theme="system" aria-pressed="false">System</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h2 class="settings-section-title">Account</h2>
                    <div class="preference-stack">
                        <article class="preference-card">
                            <div class="preference-copy">
                                <h3 class="preference-title">Password</h3>
                                <p class="preference-description">Change your password</p>
                            </div>
                            <button type="button" class="preference-action" data-action="password">Change</button>
                        </article>
                        <article class="preference-card">
                            <div class="preference-copy">
                                <h3 class="preference-title">Email</h3>
                                <p class="preference-description">Update your email address</p>
                            </div>
                            <button type="button" class="preference-action" data-action="email">Update</button>
                        </article>
                    </div>
                </div>

                <div class="settings-section">
                    <h2 class="settings-section-title">Notifications</h2>
                    <div class="preference-stack">
                        <article class="preference-card preference-card--split">
                            <div class="preference-copy">
                                <h3 class="preference-title">Email Notifications</h3>
                                <p class="preference-description">Receive email notifications about new features and updates.</p>
                            </div>
                            <div class="toggle-field">
                                <input type="checkbox" id="email-notifications" class="toggle-input" checked>
                                <label for="email-notifications" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </article>
                        <article class="preference-card preference-card--split">
                            <div class="preference-copy">
                                <h3 class="preference-title">Push Notifications</h3>
                                <p class="preference-description">Stay in the loop with timely alerts on your devices.</p>
                            </div>
                            <div class="toggle-field">
                                <input type="checkbox" id="push-notifications" class="toggle-input">
                                <label for="push-notifications" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </article>
                        <article class="preference-card preference-card--split">
                            <div class="preference-copy">
                                <h3 class="preference-title">Book Recommendations</h3>
                                <p class="preference-description">Receive personalized suggestions based on your reading habits.</p>
                            </div>
                            <div class="toggle-field">
                                <input type="checkbox" id="book-recommendations" class="toggle-input" checked>
                                <label for="book-recommendations" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </article>
                    </div>
                </div>
            </section>

            <section id="settings-panel-appearance"
                     class="settings-panel"
                     hidden
                     role="tabpanel"
                     aria-labelledby="settings-tab-appearance"
                     data-tab-panel="appearance">
                <div class="settings-section">
                    <h2 class="settings-section-title">Reader Appearance</h2>
                    <p class="settings-section-description">Fine-tune how the reader looks and feels across devices.</p>
                    <div class="preference-stack">
                        <article class="preference-card preference-card--inline">
                            <div class="preference-copy">
                                <h3 class="preference-title">Font Size</h3>
                                <p class="preference-description">Adjust global font sizes to match your comfort level.</p>
                            </div>
                            <div class="stepper">
                                <button type="button" class="stepper-btn" data-step="down" aria-label="Decrease font size">−</button>
                                <span class="stepper-value" aria-live="polite">Medium</span>
                                <button type="button" class="stepper-btn" data-step="up" aria-label="Increase font size">＋</button>
                            </div>
                        </article>
                        <article class="preference-card preference-card--inline">
                            <div class="preference-copy">
                                <h3 class="preference-title">Line Spacing</h3>
                                <p class="preference-description">Choose a spacing option for comfortable long-form reading.</p>
                            </div>
                            <div class="theme-choice-group">
                                <button type="button" class="theme-choice is-active" data-spacing="compact" aria-pressed="true">Compact</button>
                                <button type="button" class="theme-choice" data-spacing="cozy" aria-pressed="false">Cozy</button>
                                <button type="button" class="theme-choice" data-spacing="roomy" aria-pressed="false">Roomy</button>
                            </div>
                        </article>
                    </div>
                </div>
            </section>

            <section id="settings-panel-account"
                     class="settings-panel"
                     hidden
                     role="tabpanel"
                     aria-labelledby="settings-tab-account"
                     data-tab-panel="account">
                <div class="account-settings" aria-labelledby="account-settings-heading">
                    <header class="account-settings__header">
                        <h2 id="account-settings-heading" class="account-settings__title">Update Account Info</h2>
                        <p class="account-settings__description">Modify your personal details and avatar.</p>
                    </header>
                    <div class="account-settings__content" role="group" aria-label="Account details">
                        <div class="account-settings__avatar-block">
                            <div class="account-settings__avatar">
                                <img src="https://i.pravatar.cc/160?img=47" alt="Alex Cooper" />
                                <button type="button"
                                        class="account-settings__avatar-badge"
                                        aria-label="Change avatar"
                                        data-account-action="change-avatar">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M4 7H6L7.59 4.59C7.84369 4.218 8.2524 4 8.692 4H15.308C15.7476 4 16.1563 4.218 16.41 4.59L18 7H20C21.1046 7 22 7.89543 22 9V18C22 19.1046 21.1046 20 20 20H4C2.89543 20 2 19.1046 2 18V9C2 7.89543 2.89543 7 4 7Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                        <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="account-settings__avatar-actions">
                                <button type="button" class="account-settings__btn account-settings__btn--outline" data-account-action="change-photo">Change</button>
                                <button type="button" class="account-settings__btn account-settings__btn--link" data-account-action="remove-photo">Remove</button>
                            </div>
                        </div>
                        <div class="account-settings__fields">
                            <div class="account-settings__field">
                                <label class="account-settings__label" for="account-display-name">Display Name</label>
                                <input class="account-settings__input" type="text" id="account-display-name" name="DisplayName" value="Alex Cooper" placeholder="Enter display name" />
                            </div>
                            <div class="account-settings__field">
                                <label class="account-settings__label" for="account-email-address">Email Address</label>
                                <input class="account-settings__input" type="email" id="account-email-address" name="Email" value="alex.cooper@example.com" placeholder="name@email.com" />
                            </div>
                        </div>
                    </div>
                    <footer class="account-settings__footer">
                        <button type="button" class="account-settings__btn account-settings__btn--ghost" data-account-action="cancel-changes">Cancel</button>
                        <button type="button" class="account-settings__btn account-settings__btn--primary" data-account-action="save-changes">Save Changes</button>
                    </footer>
                </div>
            </section>

            <section id="settings-panel-notifications"
                     class="settings-panel"
                     hidden
                     role="tabpanel"
                     aria-labelledby="settings-tab-notifications"
                     data-tab-panel="notifications">
                <div class="settings-section">
                    <h2 class="settings-section-title">Notification Schedule</h2>
                    <p class="settings-section-description">Control how frequently we reach out to you.</p>
                    <div class="preference-stack">
                        <article class="preference-card preference-card--split">
                            <div class="preference-copy">
                                <h3 class="preference-title">Digest Emails</h3>
                                <p class="preference-description">Receive a weekly summary of activity across your clubs and shelves.</p>
                            </div>
                            <div class="toggle-field">
                                <input type="checkbox" id="digest-emails" class="toggle-input" checked>
                                <label for="digest-emails" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </article>
                        <article class="preference-card preference-card--split">
                            <div class="preference-copy">
                                <h3 class="preference-title">Quiet Hours</h3>
                                <p class="preference-description">Mute notifications each night between 10:00 PM and 7:00 AM.</p>
                            </div>
                            <button type="button" class="preference-action" data-action="quiet-hours">Edit</button>
                        </article>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabButtons = document.querySelectorAll('.settings-tab');
            const panels = document.querySelectorAll('.settings-panel');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const target = button.dataset.tab;

                    tabButtons.forEach(tab => {
                        tab.classList.toggle('is-active', tab === button);
                        tab.setAttribute('aria-selected', tab === button ? 'true' : 'false');
                    });

                    panels.forEach(panel => {
                        const isMatch = panel.dataset.tabPanel === target;
                        panel.classList.toggle('is-active', isMatch);
                        panel.toggleAttribute('hidden', !isMatch);
                    });
                });
            });

            const themeChoices = document.querySelectorAll('.theme-choice');
            themeChoices.forEach(choice => {
                choice.addEventListener('click', () => {
                    const group = choice.closest('.theme-choice-group');
                    const siblings = group.querySelectorAll('.theme-choice');

                    siblings.forEach(btn => {
                        btn.classList.toggle('is-active', btn === choice);
                        btn.setAttribute('aria-pressed', btn === choice ? 'true' : 'false');
                    });

                    console.log('Preference changed:', choice.dataset.theme ?? choice.dataset.spacing);
                });
            });

            const toggleInputs = document.querySelectorAll('.toggle-input');
            toggleInputs.forEach(toggle => {
                toggle.addEventListener('change', () => {
                    console.log('Toggle changed:', toggle.id, toggle.checked);
                });
            });

            const preferenceActions = document.querySelectorAll('.preference-action');
            preferenceActions.forEach(button => {
                const originalLabel = button.textContent.trim();

                button.addEventListener('click', () => {
                    const label = button.dataset.action ?? 'action';
                    button.classList.add('is-active');
                    button.textContent = 'Saved';

                    setTimeout(() => {
                        button.classList.remove('is-active');
                        button.textContent = originalLabel;
                    }, 1600);

                    console.log('Action triggered:', label);
                });
            });

            const accountActionButtons = document.querySelectorAll('[data-account-action]');
            accountActionButtons.forEach(button => {
                button.addEventListener('click', () => {
                    console.log('Account action triggered:', button.dataset.accountAction);
                });
            });

            const saveButton = document.querySelector('[data-account-action="save-changes"]');
            if (saveButton) {
                const defaultLabel = saveButton.textContent.trim();

                saveButton.addEventListener('click', () => {
                    if (saveButton.dataset.state === 'pending') {
                        return;
                    }

                    saveButton.dataset.state = 'pending';
                    saveButton.disabled = true;
                    saveButton.textContent = 'Saved';

                    setTimeout(() => {
                        saveButton.disabled = false;
                        saveButton.textContent = defaultLabel;
                        delete saveButton.dataset.state;
                    }, 1600);
                });
            }
        });
    </script>
}
